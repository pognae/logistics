<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
	<meta charset="utf-8">
    <meta http-equiv="Content-Language" content="ko" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
	<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
	<META HTTP-EQUIV="Expires" CONTENT="-1">
	
 	<link rel="manifest" href="/manifest.json">
	<link rel="apple-touch-icon" href="/img/touch-icon-iphone.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/img/touch-icon-ipad.png">
	<link rel="apple-touch-icon" sizes="167x167" href="/img/touch-icon-ipad-retina.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/img/touch-icon-iphone-retina.png">
	
        
	<title> :: BINBLUR :: </title>
    <link rel="shortcut icon" href="/img/warehouse1.ico">
    
    <!-- JavaScript : jQuery Library -->
    <script type="text/javascript" src="/vender/jquery/jquery-3.6.0.js"></script>
    <script type="text/javascript" src="/vender/jqueryui/jquery-ui-1.13.1/jquery-ui.js"></script>
    
	<!-- JavaScript : Bootstrap Library -->
	<script type="text/javascript" src="/vender/bootstrap/bootstrap-4.1.3/js/bootstrap.bundle.js"></script>
	
	<!-- JavaScript : font, icon Library -->
	<script type="text/javascript" src="/vender/fontAwesomeKit/fontAwesome-6.2.js"></script>
	   
    <!-- CSS : bootstrap   -->
    <link rel="stylesheet" href="/vender/bootstrap/bootstrap-4.1.3/css/bootstrap.css">
    
    <!-- CSS : Main 프레임 -->
	<link rel="stylesheet" href="/css/main/1/common.css">
	<link rel="stylesheet" href="/css/main/1/sign.css">
	
</head>
<body> 
	<div class="sign-wrap">
		<div class="signup-box">
		 	<h1 class="signup-title" th:text="${#messages.msg('sy.main.login.btnsignup')}"></h1>  
	
           	<form action="/signUp.do" method="post" name="signUpForm"> 
				<!-- 회사 (compkey)-->
				<input type="hidden" name="compkey" id="compkey"   value="000" >
                        
				<!-- Form Group (useract)-->
				<div class="form-group">
					<div>					
						<label class="small mb-1" th:for="useract" th:text="${#messages.msg('sy.main.login.useract')}"></label>
						<input type="checkbox" name="valCheckYn" style="display:none;">
                    </div>
                    <div class="flex-group">
                    	<input class="form-control" name="useract" id="useract" type="text" placeholder="Enter your ID" required>  
						<button type="button" class="btn btn-grey" name="dupuser" id="dupuser" onclick="dupuserChk()" th:text="${#messages.msg('sy.main.login.dupuseract')}"></button>
                    </div>
                    <div id="errmsg" class="idpw-check" role="alert"></div>
				</div>
				
				<!-- Form Group (passwrd)-->
                <div class="form-group">
                    <label class="small mb-1" th:for="passwrd" th:text="${#messages.msg('sy.main.login.passwrd')}"></label>
                    <input class="form-control" name="passwrd" id="passwrd" type="password" onkeyup="checkCapsLock(event)" placeholder="Enter your password" required>
					<div id="pwerr" class="idpw-check" role="alert"></div>		
				</div>
				
				<!-- passwrd 재확인 -->
				<div class="form-group">
					<label class="small mb-1" th:for="passwrd2" th:text="${#messages.msg('sy.main.login.passwrd2')}"></label> 
					<input class="form-control" name="passwrd2" id="passwrd2" type="password" placeholder="Enter your password" required>
					<div id="pwerr2" class="idpw-check" role="alert"></div>
				</div>
							
				<!-- Form Group (username)-->
                <div class="form-group">
					<label class="small mb-1" th:for="usernam" th:text="${#messages.msg('sy.main.login.usernam')}"></label>
					<input class="form-control" name="usernam" type="text" placeholder="Enter your username" value="" required>
				</div>
 
				<!-- Form Group (email address)-->
				<div class="form-group">
					<label class="small mb-1" th:for="emailad" th:text="${#messages.msg('sy.main.login.emailad')}"></label>
					<input class="form-control" name="emailad" type="email" placeholder="Enter your email address(name@example.com)" value="" required>
				</div>
							
				<!-- Form Row (휴대폰)-->
				<div class="form-group"> 
					<label class="small mb-1" th:for="telphnm" th:text="${#messages.msg('sy.main.login.telphnm')}"></label>
					<input class="form-control" name="telphnm" type="tel" placeholder="Enter your phone number" value="" required> 
				</div> 
						
				<!-- 동의서 -->
				<div class="terms-box">  
					<input type="checkbox" id="chk-1" class="check-costom check-all"><label for="chk-1"><span class="check"></span> <b th:text="${#messages.msg('su.signUpAllBtn')}"></b></label>
					<div class="check-group">
						<div>
							<input type="checkbox" name="polpryn" id="chk-2" class="check-costom">
							<label for="chk-2">
							<span class="check" th:text="${#messages.msg('su.signUpPrYn')}"></span>
							<span th:text="${#messages.msg('su.signUpRequiredBtn')}"></span>
							</label>
							<a href="/policy/accessService" target="_policy" th:text="${#messages.msg('su.signUpPolicy')}"></a>
						</div>
						<div>
							<input type="checkbox" name="polsvyn" id="chk-3" class="check-costom">
							<label for="chk-3">
							<span class="check" th:text="${#messages.msg('su.signUpSvYn')}"></span>
							<span th:text="${#messages.msg('su.signUpRequiredBtn')}"></span>
							</label>
							 <a href="/policy/accessPrivacy" target="_policy" th:text="${#messages.msg('su.signUpPolicy')}"></a>
						</div>
						<div>
							<input type="checkbox" name="chk-4" id="chk-4" class="check-costom event-check-all">
							<label for="chk-4">
						     <span class="check" th:text="${#messages.msg('su.signUpMkYn')}"></span>
						     </label>
						</div>
						<div class="event-check-group">
							<div><input type="checkbox" name="polsmyn" id="chk-5" class="check-costom"><label for="chk-5"><span class="check" th:text="${#messages.msg('su.signUpSmsYn')}"></span></label></div>
							<div><input type="checkbox" name="polemyn" id="chk-6" class="check-costom"><label for="chk-6"><span class="check" th:text="${#messages.msg('su.signUpEmailYn')}"></span></label></div>
						</div>
					</div>
					<div class="pl-30">
						<span class="terms-noti" th:text="${#messages.msg('su.signUpNotiTerms1')}"></span>
						<span class="terms-noti" th:text="${#messages.msg('su.signUpNotiTerms2')}"></span>
					</div>
				</div>
				<button class="btn btn-sign-border" type="button" onclick="location.href='/login'" th:text="${#messages.msg('su.signUp.login')}"></button>
				<button class="btn btn-sign" type="button" onclick="loginCheckAll()"th:text="${#messages.msg('sy.main.login.btnsignup')}"></button>
			</form>
		</div>
	</div>	
</body>

<script>
$(function(){
	$('#useract').focus();
	var checkAll = $('.check-all');
	var checks = $('.check-group').find('input[type="checkbox"]');
	
	checkAll.on('change',function(){
		checkAll.is(':checked')? checks.prop('checked',true) : checks.prop('checked',false)
	});
	
	
	checks.on('change',function(){
		var checked = $('.check-group').find('input[type="checkbox"]:checked');
		if( checks.length === checked.length){
			checkAll.prop('checked',true);
		} else{
			checkAll.prop('checked',false);
		}
	});

	var eventCheckAll = $('.event-check-all');
	var eventChecks = $('.event-check-group').find('input[type="checkbox"]');

	eventCheckAll.on('change',function(){
		eventCheckAll.is(':checked')? eventChecks.prop('checked',true) : eventChecks.prop('checked',false);
	});
	
	eventChecks.on('change',function(){
		var eventChecked = $('.event-check-group').find('input[type="checkbox"]:checked');

		if( eventChecks.length === eventChecked.length){
			eventCheckAll.prop('checked',true);
		} else{
			eventCheckAll.prop('checked',false);
		}
	});
	
	//============================================================	
	//패스워드 포커스 아웃 이벤트
	//============================================================
	$('#passwrd').focusout(function() {
		var reg = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;
		var hangulcheck = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;
		
		if(!reg.test($(this).val())) {
			$("#pwerr").text("[[#{sy.main.pwdValidation}]]");	//8~16자 영문 대 소문자, 숫자, 특수문자를 사용하세요.
		}else if(/(\w)\1\1\1/.test($(this).val())){
			$("#pwerr").text("[[#{sy.main.pwdValidation2}]]" ); //같은 문자를 4번 이상 사용하실 수 없습니다.
		}else if($(this).val().search($('#useract').val()) > -1){
			$("#pwerr").text("[[#{sy.main.pwdValidation3}]]"); 	//비밀번호에 아이디가 포함되었습니다.
		}else if(hangulcheck.test($(this).val())){
			$("#pwerr").text("[[#{sy.main.pwdValidation}]]"); 	//8~16자 영문 대 소문자, 숫자, 특수문자를 사용하세요.
		}else{
			$("#pwerr2").text("");
		}
	});
	
	//============================================================	
	//패스워드 재확인 포커스 아웃 이벤트
	//============================================================
	$('#passwrd2').focusout(function() {
		if($('#passwrd').val() != $(this).val()){
			$("#pwerr2").text("[[#{sy.main.pwd2Validation}]]");
		}else{
			$("#pwerr2").text("");
		}
	});

});

//============================================================	
// 중복확인 버튼 이벤트
//============================================================ 
function dupuserChk(){
	if(!$('#useract').val()){
		$("#errmsg").text("[[#{sy.main.uidValidation}]]");
		return false;
	}
	
	var data = { useract : $('#useract').val(), compkey : $('#compkey').val()};
	
	$.ajax({
		url : '/sy/findId.do',
		type :  'POST',
		data : JSON.stringify(data),
		beforeSend : function(xhr) {
			xhr.setRequestHeader("Accept", "application/json");
			xhr.setRequestHeader("Content-Type","application/json;charset=utf-8");
			xhr.setRequestHeader("AJAX", true);
		},
		success : function(data){
			$("#errmsg").text("[[#{sy.main.trueDuplication}]]");
			$('#useract').focus();
			$('input[name="valCheckYn"]').prop("checked", true);
		},
		error : function(e){
			$("#errmsg").text("[[#{sy.main.uidDuplication}]]");
			$('input[name="valCheckYn"]').prop("checked", false);
		} 
	});
};

//============================================================	
//패스워드 CapsLock 체크 이벤트
//============================================================
function checkCapsLock(evt){
	if (evt.getModifierState("CapsLock")) {
		$("#pwerr").text("[[#{sy.main.pwdCapsLock}]]");
  	}else {
  		$("#pwerr").text("");
  	}
}
 	
function loginCheckAll() {   
	var form = document.signUpForm;
	var o_useract = $("#useract");
	var o_passwrd = $("#passwrd");
	var o_passwrd2 = $("#passwrd2");
	var valCheckYn = $('input[name="valCheckYn"]').is(":checked");
	var name 	   = $('input[name="usernam"]').val();
	var email 	   = $('input[name="emailad"]').val();
	var tel        = $('input[name="telphnm"]').val();
	var privateYn = $('input[name="polpryn"]');
	var serviceYn = $('input[name="polsvyn"]');
	if (!uidValidation(o_useract) || !pwdValidation(o_useract, o_passwrd)  || 
		!tagValidation( name ,email,tel,privateYn, serviceYn) || !pwdValidation2(o_passwrd, o_passwrd2)){ 
		return false;
	}  
	form.submit();
};
	
//ID 유효성 검사
function uidValidation(o_useract){  
    //특수문자가 있는지 확인
	var spe = o_useract.val().search(/[`~!@@#$%^&*|₩₩₩'₩";:₩/?]/gi); 
    var korean = o_useract.val().search(/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/gi); 

    if ((o_useract.val().length < 4) || (o_useract.val().length > 20)) {
		alert("[[#{sy.main.uidValidation}]]");//계정(ID)는 4자리 ~ 20자리 이내로 입력해주세요.
		o_useract.focus();
		return false;
    }
    if (o_useract.val().search(/₩s/) != -1) {
		alert("[[#{sy.main.uidValidation2}]]");//계정(ID)는 공백없이 입력해주세요.
		o_useract.focus();
		return false;
    }
    if (spe > 0 || korean > 0) {
		alert("[[#{sy.main.uidValidation3}]]");//계정(ID)는 영문,숫자만 입력해주세요.
		o_useract.focus();
		return false;
    } 
    return true;
};
	
//비밀번호 유효성 검사
function pwdValidation(o_useract, o_passwrd){  
	var reg = /^(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;
	var hangulcheck = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;
	 
	if(false === reg.test(o_passwrd.val()) ) {
		alert("[[#{sy.main.pwdValidation}]]"); //8~16자 영문 대 소문자, 숫자, 특수문자를 사용하세요.
		o_passwrd.focus();
		return false;
	}else if(/(\w)\1\1\1/.test(o_passwrd.val())){
	 	alert("[[#{sy.main.pwdValidation2}]]" ); //같은 문자를 4번 이상 사용하실 수 없습니다.
	 	o_passwrd.focus();
	 	return false;
	}else if(o_passwrd.val().search(o_useract.val()) > -1){
	 	alert("[[#{sy.main.pwdValidation3}]]"); //비밀번호에 아이디가 포함되었습니다.
	 	o_passwrd.focus();
	 	return false;
	}else if(o_passwrd.val().search(/\s/) != -1){
	 	alert("[[#{sy.main.pwdValidation4}]]");//비밀번호는 공백 없이 입력해주세요
	 	o_passwrd.focus();
	 	return false;
	}else if(hangulcheck.test(o_passwrd.val())){
	 	alert("[[#{sy.main.pwdValidation5}]]"); //비밀번호에 한글을 사용 할 수 없습니다.
	 	o_passwrd.focus();
	 	return false;
	}else {
		return true;
	} 
};
	
//============================================================	
//패스워드 재확인 유효성 검사
//============================================================
function pwdValidation2(o_passwrd, o_passwrd2){
	if(o_passwrd.val() != o_passwrd2.val()){
		alert("[[#{sy.main.pwd2Validation}]]"); //비밀번호가 일치하지 않습니다.
		o_passwrd2.focus();
		return false;
	}else{
		return true;
	}
}
	
function tagValidation(name, email, telphnm, privateYn, serviceYn){
	if(name == ""){
		alert("[[#{su.nameVal}]]");
		return false;
	}
	if(email == ""){
		alert("[[#{su.emailVal}]]");
		return false;
	}
	if(telphnm == ""){
		alert("[[#{su.telVal}]]");
		return false;
	}
	if(privateYn[0].checked == false || serviceYn[0].checked == false){
		privateYn.focus();
		alert("[[#{sy.main.requiredValidation6}]]");
		return false;
	}
	return true;
};
	
// id 중복 검사
function idValidation(valCheckYn){
	if(valCheckYn == false){
		alert("[[#{sy.main.chkIdValidation}]]");
		return false;
	}
	return true;
}
	
</script>

</html>